{% extends 'base.html.twig' %}

{% block title %}Ajouter un trick{% endblock %}

{% block body %}
    <section class="login">
        <h1>Ajouter un trick</h1>

   {{ form_start(form) }}
        {{ form_row(form.name) }}
        {{ form_row(form.description) }}
         {{ form_row(form.mainImage) }}
        {{ form_label(form.images) }}
        <ul class="images">
      {{ form_widget(form.images, {'attr': {'class': 'custom-file-input', 'multiple': true}}) }}
        </ul>
    <div class="form-group">
        <button type="button" class="btn btn-success" id="add_image">Ajouter une image</button>
    </div>

    <div id="images_container"
         data-prototype="{{ form_widget(form.images.vars.prototype)|e('html_attr') }}">
    </div>

    <button type="submit" class="btn btn-primary">Ajouter</button>
{{ form_end(form) }}

<script>
    const imagesContainer = document.getElementById('images_container');
    const addButton = document.getElementById('add_image');

    addButton.addEventListener('click', () => {
        const prototype = imagesContainer.getAttribute('data-prototype');
        const index = imagesContainer.children.length;

        const formGroup = document.createElement('div');
        formGroup.classList.add('form-group');

        const newImage = prototype.replace(/__name__/g, index);

        const imageWrapper = document.createElement('div');
        imageWrapper.classList.add('form-group');
        imageWrapper.innerHTML = newImage;

        formGroup.appendChild(imageWrapper);
        imagesContainer.appendChild(formGroup);
    });
</script>

    </section>
{% endblock %}
